(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1704:(e,t,a)=>{Promise.resolve().then(a.bind(a,9069))},9069:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>e0});var r,s=a(5155),n=a(2115);class o extends Error{constructor(e,t,a){super(a),this.name="ApiError",this.url=t.url,this.status=t.status,this.statusText=t.statusText,this.body=t.body,this.request=e}}var i=a(7325),l=a(5777),c=a(5378);class d extends Error{get isCancelled(){return!0}constructor(e){super(e),this.name="CancelError"}}var u=new WeakMap,h=new WeakMap,m=new WeakMap,x=new WeakMap,f=new WeakMap,p=new WeakMap,g=new WeakMap;class b{get[Symbol.toStringTag](){return"Cancellable Promise"}then(e,t){return(0,i._)(this,f).then(e,t)}catch(e){return(0,i._)(this,f).catch(e)}finally(e){return(0,i._)(this,f).finally(e)}cancel(){if(!((0,i._)(this,u)||(0,i._)(this,h)||(0,i._)(this,m))){if((0,c._)(this,m,!0),(0,i._)(this,x).length)try{for(let e of(0,i._)(this,x))e()}catch(e){console.warn("Cancellation threw an error",e);return}(0,i._)(this,x).length=0,(0,i._)(this,g)&&(0,i._)(this,g).call(this,new d("Request aborted"))}}get isCancelled(){return(0,i._)(this,m)}constructor(e){(0,l._)(this,u,{writable:!0,value:void 0}),(0,l._)(this,h,{writable:!0,value:void 0}),(0,l._)(this,m,{writable:!0,value:void 0}),(0,l._)(this,x,{writable:!0,value:void 0}),(0,l._)(this,f,{writable:!0,value:void 0}),(0,l._)(this,p,{writable:!0,value:void 0}),(0,l._)(this,g,{writable:!0,value:void 0}),(0,c._)(this,u,!1),(0,c._)(this,h,!1),(0,c._)(this,m,!1),(0,c._)(this,x,[]),(0,c._)(this,f,new Promise((t,a)=>{(0,c._)(this,p,t),(0,c._)(this,g,a);let r=e=>{!((0,i._)(this,u)||(0,i._)(this,h)||(0,i._)(this,m))&&((0,c._)(this,u,!0),(0,i._)(this,p)&&(0,i._)(this,p).call(this,e))},s=e=>{!((0,i._)(this,u)||(0,i._)(this,h)||(0,i._)(this,m))&&((0,c._)(this,h,!0),(0,i._)(this,g)&&(0,i._)(this,g).call(this,e))},n=e=>{(0,i._)(this,u)||(0,i._)(this,h)||(0,i._)(this,m)||(0,i._)(this,x).push(e)};return Object.defineProperty(n,"isResolved",{get:()=>(0,i._)(this,u)}),Object.defineProperty(n,"isRejected",{get:()=>(0,i._)(this,h)}),Object.defineProperty(n,"isCancelled",{get:()=>(0,i._)(this,m)}),e(r,s,n)}))}}let v={BASE:"",VERSION:"1.0.0",WITH_CREDENTIALS:!1,CREDENTIALS:"include",TOKEN:void 0,USERNAME:void 0,PASSWORD:void 0,HEADERS:void 0,ENCODE_PATH:void 0};!function(e){var t;(t=e.status||(e.status={})).RESERVED="RESERVED",t.PENDING_APPROVAL="PENDING_APPROVAL",t.APPROVED="APPROVED",t.REJECTED="REJECTED",t.COMPLETED="COMPLETED",t.FAILED="FAILED"}(r||(r={}));var j=a(5125),y=a(7482),w=a.n(y),_=a(5376).Buffer;let N=e=>"string"==typeof e&&""!==e,E=e=>"object"==typeof e&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.arrayBuffer&&"function"==typeof e.constructor&&"string"==typeof e.constructor.name&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag]),S=async(e,t)=>"function"==typeof t?t(e):t,k=async(e,t,a)=>{let[r,s,n,o]=await Promise.all([S(t,e.TOKEN),S(t,e.USERNAME),S(t,e.PASSWORD),S(t,e.HEADERS)]),i="function"==typeof(null==a?void 0:a.getHeaders)&&(null==a?void 0:a.getHeaders())||{},l=Object.entries({Accept:"application/json",...o,...t.headers,...i}).filter(e=>{let[t,a]=e;return null!=a}).reduce((e,t)=>{let[a,r]=t;return{...e,[a]:String(r)}},{});if(N(r)&&(l.Authorization="Bearer ".concat(r)),N(s)&&N(n)){let e=(e=>{try{return btoa(e)}catch(t){return _.from(e).toString("base64")}})("".concat(s,":").concat(n));l.Authorization="Basic ".concat(e)}return void 0!==t.body&&(t.mediaType?l["Content-Type"]=t.mediaType:E(t.body)?l["Content-Type"]=t.body.type||"application/octet-stream":"string"==typeof t.body?l["Content-Type"]="text/plain":t.body instanceof w()||(l["Content-Type"]="application/json")),l},T=async(e,t,a,r,s,n,o,i)=>{let l=j.A.CancelToken.source(),c={url:a,headers:n,data:null!=r?r:s,method:t.method,withCredentials:e.WITH_CREDENTIALS,withXSRFToken:"include"===e.CREDENTIALS&&e.WITH_CREDENTIALS,cancelToken:l.token};o(()=>l.cancel("The user aborted a request."));try{return await i.request(c)}catch(e){if(e.response)return e.response;throw e}},A=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j.A;return new b(async(r,s,n)=>{try{let s=((e,t)=>{let a=e.ENCODE_PATH||encodeURI,r=t.url.replace("{api-version}",e.VERSION).replace(/{(.*?)}/g,(e,r)=>{var s;return(null==(s=t.path)?void 0:s.hasOwnProperty(r))?a(String(t.path[r])):e}),s="".concat(e.BASE).concat(r);return t.query?"".concat(s).concat((e=>{let t=[],a=(e,r)=>{let s;if(s=r,null!=s)if(Array.isArray(r))r.forEach(t=>{a(e,t)});else if("object"==typeof r)Object.entries(r).forEach(t=>{let[r,s]=t;a("".concat(e,"[").concat(r,"]"),s)});else t.push("".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(String(r))))};return(Object.entries(e).forEach(e=>{let[t,r]=e;a(t,r)}),t.length>0)?"?".concat(t.join("&")):""})(t.query)):s})(e,t),i=(e=>{if(e.formData){let t=new(w()),a=(e,a)=>{"string"==typeof a||E(a)?t.append(e,a):t.append(e,JSON.stringify(a))};return Object.entries(e.formData).filter(e=>{let t,[a,r]=e;return t=r,null!=t}).forEach(e=>{let[t,r]=e;Array.isArray(r)?r.forEach(e=>a(t,e)):a(t,r)}),t}})(t),l=(e=>{if(e.body)return e.body})(t),c=await k(e,t,i);if(!n.isCancelled){let d,u=await T(e,t,s,l,i,c,n,a),h=(e=>{if(204!==e.status)return e.data})(u),m=((e,t)=>{if(t){let a=e.headers[t];if("string"==typeof a)return a}})(u,t.responseHeader),x={url:s,ok:(d=u.status)>=200&&d<300,status:u.status,statusText:u.statusText,body:null!=m?m:h};((e,t)=>{let a={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable",...e.errors}[t.status];if(a)throw new o(e,t,a);if(!t.ok){var r,s;let a=null!=(r=t.status)?r:"unknown",n=null!=(s=t.statusText)?s:"unknown",i=(()=>{try{return JSON.stringify(t.body,null,2)}catch(e){return}})();throw new o(e,t,"Generic Error: status: ".concat(a,"; status text: ").concat(n,"; body: ").concat(i))}})(t,x),r(x.body)}}catch(e){s(e)}})};class C{static scheduleTransaction(e){return A(v,{method:"POST",url:"/transactions",body:e,mediaType:"application/json",errors:{400:"Invalid request body",422:"Insufficient funds or other processing error"}})}static getTransactionById(e){return A(v,{method:"GET",url:"/transactions/{transactionId}",path:{transactionId:e},errors:{404:"Transaction not found"}})}static cancelTransactionById(e){return A(v,{method:"DELETE",url:"/transactions/{transactionId}",path:{transactionId:e},errors:{404:"Transaction not found or not in a cancellable state",409:"Transaction is not in a cancellable state"}})}static createWallet(e){return A(v,{method:"POST",url:"/wallets",body:e,mediaType:"application/json",errors:{409:"Wallet for this user already exists"}})}static listWallets(){return A(v,{method:"GET",url:"/wallets"})}static getWalletByUserId(e){return A(v,{method:"GET",url:"/wallets/{userId}",path:{userId:e},errors:{404:"Wallet not found"}})}static deleteWallet(e){return A(v,{method:"DELETE",url:"/wallets/{userId}",path:{userId:e},errors:{404:"Wallet not found"}})}static listTransactionsByUserId(e){return A(v,{method:"GET",url:"/users/{userId}/transactions",path:{userId:e}})}static listLedgerEntries(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return A(v,{method:"GET",url:"/ledger",query:{limit:e}})}}var I=a(2467),D=a(3101),P=a(2821),R=a(5889);function O(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,R.QP)((0,P.$)(t))}let W=(0,D.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function z(e){let{className:t,variant:a,size:r,asChild:n=!1,...o}=e,i=n?I.DX:"button";return(0,s.jsx)(i,{"data-slot":"button",className:O(W({variant:a,size:r,className:t})),...o})}var L=a(3161);function F(e){let{...t}=e;return(0,s.jsx)(L._s.Root,{"data-slot":"drawer",...t})}function V(e){let{...t}=e;return(0,s.jsx)(L._s.Trigger,{"data-slot":"drawer-trigger",...t})}function B(e){let{...t}=e;return(0,s.jsx)(L._s.Portal,{"data-slot":"drawer-portal",...t})}function M(e){let{className:t,...a}=e;return(0,s.jsx)(L._s.Overlay,{"data-slot":"drawer-overlay",className:O("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function U(e){let{className:t,children:a,...r}=e;return(0,s.jsxs)(B,{"data-slot":"drawer-portal",children:[(0,s.jsx)(M,{}),(0,s.jsxs)(L._s.Content,{"data-slot":"drawer-content",className:O("group/drawer-content bg-background fixed z-50 flex h-auto flex-col","data-[vaul-drawer-direction=top]:inset-x-0 data-[vaul-drawer-direction=top]:top-0 data-[vaul-drawer-direction=top]:mb-24 data-[vaul-drawer-direction=top]:max-h-[80vh] data-[vaul-drawer-direction=top]:rounded-b-lg data-[vaul-drawer-direction=top]:border-b","data-[vaul-drawer-direction=bottom]:inset-x-0 data-[vaul-drawer-direction=bottom]:bottom-0 data-[vaul-drawer-direction=bottom]:mt-24 data-[vaul-drawer-direction=bottom]:max-h-[80vh] data-[vaul-drawer-direction=bottom]:rounded-t-lg data-[vaul-drawer-direction=bottom]:border-t","data-[vaul-drawer-direction=right]:inset-y-0 data-[vaul-drawer-direction=right]:right-0 data-[vaul-drawer-direction=right]:w-3/4 data-[vaul-drawer-direction=right]:border-l data-[vaul-drawer-direction=right]:sm:max-w-sm","data-[vaul-drawer-direction=left]:inset-y-0 data-[vaul-drawer-direction=left]:left-0 data-[vaul-drawer-direction=left]:w-3/4 data-[vaul-drawer-direction=left]:border-r data-[vaul-drawer-direction=left]:sm:max-w-sm",t),...r,children:[(0,s.jsx)("div",{className:"bg-muted mx-auto mt-4 hidden h-2 w-[100px] shrink-0 rounded-full group-data-[vaul-drawer-direction=bottom]/drawer-content:block"}),a]})]})}function q(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"drawer-header",className:O("flex flex-col gap-0.5 p-4 group-data-[vaul-drawer-direction=bottom]/drawer-content:text-center group-data-[vaul-drawer-direction=top]/drawer-content:text-center md:gap-1.5 md:text-left",t),...a})}function G(e){let{className:t,...a}=e;return(0,s.jsx)(L._s.Title,{"data-slot":"drawer-title",className:O("text-foreground font-semibold",t),...a})}function H(e){let{className:t,...a}=e;return(0,s.jsx)(L._s.Description,{"data-slot":"drawer-description",className:O("text-muted-foreground text-sm",t),...a})}function J(){let[e,t]=(0,n.useState)([]),[a,r]=(0,n.useState)(!1),o=async()=>{r(!0);try{let e=await C.listLedgerEntries();t(e)}catch(e){console.error("Failed to fetch ledger entries:",e),alert("Failed to fetch ledger entries.")}finally{r(!1)}};return(0,s.jsxs)(F,{children:[(0,s.jsx)(V,{asChild:!0,children:(0,s.jsx)(z,{variant:"outline",onClick:o,children:"Ledger"})}),(0,s.jsxs)(U,{children:[(0,s.jsxs)(q,{children:[(0,s.jsx)(G,{children:"Recent Ledger Entries"}),(0,s.jsx)(H,{children:"Showing the most recent ledger activities."})]}),(0,s.jsx)("div",{className:"px-4 max-h-[60vh] overflow-y-auto",children:a?(0,s.jsx)("p",{className:"text-center",children:"Loading ledger..."}):e.length>0?(0,s.jsx)("ul",{className:"space-y-4",children:e.map(e=>{var t;let a=e.credit&&e.credit>0,r=a?e.credit:e.debit;return(0,s.jsxs)("li",{className:"border-b pb-3 text-sm flex items-center gap-4",children:[(0,s.jsxs)("p",{className:"font-bold text-lg w-24 text-right ".concat(a?"text-green-500":"text-red-500"),children:[a?"+":"-",r]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold truncate",children:e.description}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["Tx: ",null==(t=e.transaction_id)?void 0:t.substring(0,8),"..."]}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:e.timestamp?new Date(e.timestamp).toLocaleString():"N/A"})]})]},e.entry_id)})}):(0,s.jsx)("p",{className:"text-center",children:"No ledger entries found."})})]})]})}var Y=a(2544),Z=a(6942),K=a(1508),X=a(9675),$=a(7539),Q=a(5229);function ee(e){let{...t}=e;return(0,s.jsx)($.bL,{"data-slot":"dialog",...t})}function et(e){let{...t}=e;return(0,s.jsx)($.l9,{"data-slot":"dialog-trigger",...t})}function ea(e){let{...t}=e;return(0,s.jsx)($.ZL,{"data-slot":"dialog-portal",...t})}function er(e){let{className:t,...a}=e;return(0,s.jsx)($.hJ,{"data-slot":"dialog-overlay",className:O("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function es(e){let{className:t,children:a,showCloseButton:r=!0,...n}=e;return(0,s.jsxs)(ea,{"data-slot":"dialog-portal",children:[(0,s.jsx)(er,{}),(0,s.jsxs)($.UC,{"data-slot":"dialog-content",className:O("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...n,children:[a,r&&(0,s.jsxs)($.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,s.jsx)(Q.A,{}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function en(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"dialog-header",className:O("flex flex-col gap-2 text-center sm:text-left",t),...a})}function eo(e){let{className:t,...a}=e;return(0,s.jsx)($.hE,{"data-slot":"dialog-title",className:O("text-lg leading-none font-semibold",t),...a})}function ei(e){let{className:t,...a}=e;return(0,s.jsx)($.VY,{"data-slot":"dialog-description",className:O("text-muted-foreground text-sm",t),...a})}var el=a(489);function ec(e){let{className:t,...a}=e;return(0,s.jsx)(el.b,{"data-slot":"label",className:O("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...a})}let ed=Y.Op,eu=n.createContext({}),eh=e=>{let{...t}=e;return(0,s.jsx)(eu.Provider,{value:{name:t.name},children:(0,s.jsx)(Y.xI,{...t})})},em=()=>{let e=n.useContext(eu),t=n.useContext(ex),{getFieldState:a}=(0,Y.xW)(),r=(0,Y.lN)({name:e.name}),s=a(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");let{id:o}=t;return{id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message"),...s}},ex=n.createContext({});function ef(e){let{className:t,...a}=e,r=n.useId();return(0,s.jsx)(ex.Provider,{value:{id:r},children:(0,s.jsx)("div",{"data-slot":"form-item",className:O("grid gap-2",t),...a})})}function ep(e){let{className:t,...a}=e,{error:r,formItemId:n}=em();return(0,s.jsx)(ec,{"data-slot":"form-label","data-error":!!r,className:O("data-[error=true]:text-destructive",t),htmlFor:n,...a})}function eg(e){let{...t}=e,{error:a,formItemId:r,formDescriptionId:n,formMessageId:o}=em();return(0,s.jsx)(I.DX,{"data-slot":"form-control",id:r,"aria-describedby":a?"".concat(n," ").concat(o):"".concat(n),"aria-invalid":!!a,...t})}function eb(e){var t;let{className:a,...r}=e,{error:n,formMessageId:o}=em(),i=n?String(null!=(t=null==n?void 0:n.message)?t:""):r.children;return i?(0,s.jsx)("p",{"data-slot":"form-message",id:o,className:O("text-destructive text-sm",a),...r,children:i}):null}function ev(e){let{className:t,type:a,...r}=e;return(0,s.jsx)("input",{type:a,"data-slot":"input",className:O("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...r})}var ej=a(8720);let ey=K.Ikc({user_id:K.YjP().min(1,"User ID is required"),name:K.YjP().min(1,"Wallet name is required")});function ew(e){let{onWalletCreated:t}=e,[a,r]=(0,n.useState)(!1),i=(0,Y.mN)({resolver:(0,Z.u)(ey),defaultValues:{user_id:"",name:""}}),l=async e=>{try{await C.createWallet(e),ej.o.success("Wallet created successfully!"),i.reset(),r(!1),t()}catch(t){var a;let e=t instanceof o?"Failed to create wallet: ".concat(null==(a=t.body)?void 0:a.message):"An unexpected error occurred.";ej.o.error(e),console.error(t)}};return(0,s.jsxs)(ee,{open:a,onOpenChange:e=>{e&&i.reset({user_id:(0,X.A)(),name:""}),r(e)},children:[(0,s.jsx)(et,{asChild:!0,children:(0,s.jsx)(z,{children:"Create New Wallet"})}),(0,s.jsxs)(es,{children:[(0,s.jsx)(en,{children:(0,s.jsx)(eo,{children:"Create a New Wallet"})}),(0,s.jsx)(ed,{...i,children:(0,s.jsxs)("form",{onSubmit:i.handleSubmit(l),className:"space-y-4",children:[(0,s.jsx)(eh,{control:i.control,name:"user_id",render:e=>{let{field:t}=e;return(0,s.jsxs)(ef,{children:[(0,s.jsx)(ep,{children:"User ID"}),(0,s.jsx)(eg,{children:(0,s.jsx)(ev,{...t,disabled:!0})}),(0,s.jsx)(eb,{})]})}}),(0,s.jsx)(eh,{control:i.control,name:"name",render:e=>{let{field:t}=e;return(0,s.jsxs)(ef,{children:[(0,s.jsx)(ep,{children:"Wallet Name"}),(0,s.jsx)(eg,{children:(0,s.jsx)(ev,{placeholder:"e.g., My Savings",...t})}),(0,s.jsx)(eb,{})]})}}),(0,s.jsx)(z,{type:"submit",disabled:i.formState.isSubmitting,children:i.formState.isSubmitting?"Creating...":"Create"})]})})]})]})}var e_=a(5646);function eN(e){let{...t}=e;return(0,s.jsx)(e_.bL,{"data-slot":"alert-dialog",...t})}function eE(e){let{...t}=e;return(0,s.jsx)(e_.ZL,{"data-slot":"alert-dialog-portal",...t})}function eS(e){let{className:t,...a}=e;return(0,s.jsx)(e_.hJ,{"data-slot":"alert-dialog-overlay",className:O("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function ek(e){let{className:t,...a}=e;return(0,s.jsxs)(eE,{children:[(0,s.jsx)(eS,{}),(0,s.jsx)(e_.UC,{"data-slot":"alert-dialog-content",className:O("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...a})]})}function eT(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"alert-dialog-header",className:O("flex flex-col gap-2 text-center sm:text-left",t),...a})}function eA(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"alert-dialog-footer",className:O("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...a})}function eC(e){let{className:t,...a}=e;return(0,s.jsx)(e_.hE,{"data-slot":"alert-dialog-title",className:O("text-lg font-semibold",t),...a})}function eI(e){let{className:t,...a}=e;return(0,s.jsx)(e_.VY,{"data-slot":"alert-dialog-description",className:O("text-muted-foreground text-sm",t),...a})}function eD(e){let{className:t,...a}=e;return(0,s.jsx)(e_.rc,{className:O(W(),t),...a})}function eP(e){let{className:t,...a}=e;return(0,s.jsx)(e_.ZD,{className:O(W({variant:"outline"}),t),...a})}var eR=a(646),eO=a(4033),eW=a(5917),ez=a(2108);function eL(e){let{...t}=e;return(0,s.jsx)(eR.bL,{"data-slot":"select",...t})}function eF(e){let{...t}=e;return(0,s.jsx)(eR.WT,{"data-slot":"select-value",...t})}function eV(e){let{className:t,size:a="default",children:r,...n}=e;return(0,s.jsxs)(eR.l9,{"data-slot":"select-trigger","data-size":a,className:O("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n,children:[r,(0,s.jsx)(eR.In,{asChild:!0,children:(0,s.jsx)(eO.A,{className:"size-4 opacity-50"})})]})}function eB(e){let{className:t,children:a,position:r="popper",...n}=e;return(0,s.jsx)(eR.ZL,{children:(0,s.jsxs)(eR.UC,{"data-slot":"select-content",className:O("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...n,children:[(0,s.jsx)(eU,{}),(0,s.jsx)(eR.LM,{className:O("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),(0,s.jsx)(eq,{})]})})}function eM(e){let{className:t,children:a,...r}=e;return(0,s.jsxs)(eR.q7,{"data-slot":"select-item",className:O("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...r,children:[(0,s.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,s.jsx)(eR.VF,{children:(0,s.jsx)(eW.A,{className:"size-4"})})}),(0,s.jsx)(eR.p4,{children:a})]})}function eU(e){let{className:t,...a}=e;return(0,s.jsx)(eR.PP,{"data-slot":"select-scroll-up-button",className:O("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(ez.A,{className:"size-4"})})}function eq(e){let{className:t,...a}=e;return(0,s.jsx)(eR.wn,{"data-slot":"select-scroll-down-button",className:O("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(eO.A,{className:"size-4"})})}function eG(e){let{status:t}=e;return(0,s.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat((()=>{switch(t){case"COMPLETED":return"bg-green-100 text-green-800";case"FAILED":case"REJECTED":return"bg-red-100 text-red-800";case"RESERVED":case"PENDING_APPROVAL":case"APPROVED":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}})()),children:t||"UNKNOWN"})}function eH(e){let{executionTime:t}=e,[a,r]=(0,n.useState)(""),[o,i]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{let e=setInterval(()=>{let a=new Date,s=t.getTime()-a.getTime();if(s<=0){r("0:00"),i(!0),clearInterval(e);return}let n=Math.floor(s/1e3/60),o=Math.floor(s/1e3%60);r("".concat(n,":").concat(o.toString().padStart(2,"0")))},1e3);return()=>clearInterval(e)},[t]),a)?(0,s.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(o?"bg-red-500 text-white":"bg-gray-200 text-gray-800"),children:a}):null}let eJ=K.Ikc({to_user_id:K.YjP().min(1,"Destination wallet is required."),amount:K.YjP().min(1,"Amount is required."),delay_seconds:K.YjP().optional()}),eY=[r.status.RESERVED,r.status.PENDING_APPROVAL,r.status.APPROVED];function eZ(e){let{sourceWallet:t,allWallets:a,isOpen:i,onOpenChange:l,onTransactionScheduled:c}=e,[d,u]=(0,n.useState)("form"),[h,m]=(0,n.useState)([]),[x,f]=(0,n.useState)(!1),[p,g]=(0,n.useState)(null),b=(0,Y.mN)({resolver:(0,Z.u)(eJ),defaultValues:{to_user_id:"",amount:"",delay_seconds:""}}),v=a.filter(e=>e.user_id&&e.user_id!==t.user_id),j=(0,n.useCallback)(async()=>{if(t.user_id){f(!0);try{let e=await C.listTransactionsByUserId(t.user_id);m(e),u("transactions")}catch(e){ej.o.error("Failed to fetch transactions."),console.error(e)}finally{f(!1)}}},[t.user_id]);(0,n.useEffect)(()=>{"transactions"===d&&j()},[d,j]);let y=async e=>{let a=parseInt(e.amount,10),r=e.delay_seconds?parseInt(e.delay_seconds,10):0;if(isNaN(a)||a<=0)return void ej.o.error("Amount must be a positive number.");if(isNaN(r)||r<0||r>900)return void ej.o.error("Delay must be between 0 and 900 seconds.");if(!t.user_id)return void ej.o.error("Source wallet has no ID!");let s={from_user_id:t.user_id,to_user_id:e.to_user_id,amount:a,delay_seconds:r};try{await C.scheduleTransaction(s),ej.o.success("Transaction scheduled successfully!"),l(!1),c()}catch(t){let e="An unexpected error occurred.";if(t instanceof o){let a=t.body;e="Failed to schedule transaction: ".concat((null==a?void 0:a.message)||t.statusText)}else t instanceof Error&&(e=t.message);ej.o.error(e),console.error(t)}},w=async()=>{if(!p||!p.id)return;let e=p.id;try{await C.cancelTransactionById(e),m(t=>t.map(t=>t.id===e?{...t,status:r.status.REJECTED}:t)),c(),ej.o.success("Transaction canceled successfully!"),g(null)}catch(t){let e="An unexpected error occurred.";if(t instanceof o){let a=t.body;e="Failed to cancel transaction: ".concat(null==a?void 0:a.message)}else t instanceof Error&&(e=t.message);ej.o.error(e),console.error(t)}};return(0,s.jsx)(ee,{open:i,onOpenChange:l,children:(0,s.jsxs)(es,{className:"sm:max-w-lg",children:[(0,s.jsxs)(en,{children:[(0,s.jsxs)(eo,{children:["New Transaction from ",t.name]}),(0,s.jsxs)(ei,{children:["Balance: ",t.balance]})]}),"form"===d?(0,s.jsx)(ed,{...b,children:(0,s.jsxs)("form",{onSubmit:b.handleSubmit(y),className:"space-y-4",children:[(0,s.jsx)(eh,{control:b.control,name:"to_user_id",render:e=>{let{field:t}=e;return(0,s.jsxs)(ef,{children:[(0,s.jsx)(ep,{children:"To"}),(0,s.jsxs)(eL,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,s.jsx)(eg,{children:(0,s.jsx)(eV,{children:(0,s.jsx)(eF,{placeholder:"Select a destination wallet"})})}),(0,s.jsx)(eB,{children:v.map(e=>(0,s.jsxs)(eM,{value:e.user_id,children:[e.name," (",e.user_id,")"]},e.user_id))})]}),(0,s.jsx)(eb,{})]})}}),(0,s.jsx)(eh,{control:b.control,name:"amount",render:e=>{let{field:t}=e;return(0,s.jsxs)(ef,{children:[(0,s.jsx)(ep,{children:"Amount"}),(0,s.jsx)(eg,{children:(0,s.jsx)(ev,{type:"number",placeholder:"0",...t})}),(0,s.jsx)(eb,{})]})}}),(0,s.jsx)(eh,{control:b.control,name:"delay_seconds",render:e=>{let{field:t}=e;return(0,s.jsxs)(ef,{children:[(0,s.jsx)(ep,{children:"Delay (seconds)"}),(0,s.jsx)(eg,{children:(0,s.jsx)(ev,{type:"number",placeholder:"0",...t})}),(0,s.jsx)(eb,{})]})}}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)(z,{type:"submit",disabled:b.formState.isSubmitting,children:b.formState.isSubmitting?"Scheduling...":"Schedule Transaction"}),(0,s.jsx)(z,{type:"button",variant:"outline",onClick:j,children:"Outgoing Transactions"})]})]})}):(0,s.jsxs)("div",{children:[(0,s.jsx)(z,{variant:"outline",onClick:()=>u("form"),className:"mb-4",children:"Back to Form"}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Outgoing Transactions"}),x?(0,s.jsx)("p",{children:"Loading transactions..."}):h.length>0?(0,s.jsx)("ul",{className:"space-y-2 max-h-60 overflow-y-auto",children:h.map(e=>(0,s.jsxs)("li",{className:"flex justify-between items-center border-b pb-2 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"To:"})," ",e.to_user_id]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Amount:"})," ",e.amount]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("strong",{children:"Status:"}),(0,s.jsx)(eG,{status:e.status}),e.created_at&&e.delay_seconds&&e.delay_seconds>0&&eY.includes(e.status)&&(0,s.jsx)(eH,{executionTime:new Date(new Date(e.created_at).getTime()+1e3*e.delay_seconds)})]})]}),e.status&&eY.includes(e.status)&&(0,s.jsx)(z,{variant:"destructive",size:"sm",onClick:()=>g(e),children:"Cancel"})]},e.id))}):(0,s.jsx)("p",{children:"No outgoing transactions found."})]}),(0,s.jsx)(eN,{open:!!p,onOpenChange:()=>g(null),children:(0,s.jsxs)(ek,{children:[(0,s.jsxs)(eT,{children:[(0,s.jsx)(eC,{children:"Are you sure?"}),(0,s.jsx)(eI,{children:"This action will cancel the transaction. This cannot be undone."})]}),(0,s.jsxs)(eA,{children:[(0,s.jsx)(eP,{children:"Back"}),(0,s.jsx)(eD,{onClick:w,children:"Yes, cancel"})]})]})})]})})}function eK(e){let{wallets:t,onWalletClick:a}=e;return(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.length>0?t.map(e=>(0,s.jsxs)("div",{className:"border rounded-lg p-4 shadow-sm cursor-pointer hover:shadow-md transition-shadow",onClick:()=>a(e),children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:e.name}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["User ID: ",e.user_id]}),(0,s.jsxs)("p",{className:"text-lg font-mono mt-2",children:["Balance: ",e.balance]})]},e.user_id)):(0,s.jsx)("p",{children:"No wallets found. Create one to get started!"})})}class eX{connect(){if(this.socket&&this.socket.readyState===WebSocket.OPEN)return void console.log("WebSocket is already connected.");this.socket=new WebSocket("wss://1ex23kq855.execute-api.us-west-2.amazonaws.com/ws"),this.socket.onopen=()=>{console.log("WebSocket connection established."),this.reconnectAttempts=0},this.socket.onmessage=e=>{console.log("Message from server: ",e.data),this.handleMessage(e.data)},this.socket.onclose=e=>{console.log("WebSocket connection closed.",e),this.reconnectAttempts<this.maxReconnectAttempts?setTimeout(()=>{this.reconnectAttempts++,console.log("Reconnecting... Attempt ".concat(this.reconnectAttempts)),this.connect()},this.reconnectInterval):console.error("Max reconnect attempts reached.")},this.socket.onerror=e=>{console.error("WebSocket error: ",e)}}disconnect(){this.socket&&(this.socket.close(),this.socket=null,console.log("WebSocket connection closed by client."))}handleMessage(e){let t;try{t=JSON.parse(e)}catch(a){t=e}this.subscribers.forEach(e=>e(t))}subscribe(e){return this.subscribers.add(e),console.log("New subscriber added."),()=>{this.subscribers.delete(e),console.log("Subscriber removed.")}}constructor(){this.socket=null,this.subscribers=new Set,this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.reconnectInterval=3e3}}let e$=new eX;function eQ(e){let{wallets:t,onWalletUpdate:a,onTransactionUpdate:r}=e,o=(0,n.useRef)(new Set);return(0,n.useEffect)(()=>{e$.connect();let e=e$.subscribe(e=>{var n;if("walletUpdate"===e.type&&"object"==typeof(n=e.payload)&&null!==n&&"user_id"in n&&"change"in n&&"new_balance"in n){a();let{user_id:n,transaction_id:i,change:l,new_balance:c}=e.payload;if(i&&r(),i&&o.current.has(i))return void console.log("Duplicate message received for transaction ".concat(i,". Ignoring."));i&&(o.current.add(i),setTimeout(()=>{o.current.delete(i)},2e3));let d=t.find(e=>e.user_id===n),u=d?d.name:"Unknown";l>0&&ej.o.success("".concat(u,"'s wallet was credited!"),{description:"+".concat(l," units. New balance: ").concat(c," units."),icon:(0,s.jsx)("div",{style:{color:"oklch(var(--chart-4))"},children:"✓"})})}});return()=>{e()}},[a,r,t]),null}function e0(){let[e,t]=(0,n.useState)([]),[a,r]=(0,n.useState)(!0),[i,l]=(0,n.useState)(null),[c,d]=(0,n.useState)(null),u=(0,n.useCallback)(async()=>{try{let e=await C.listWallets();t(e),l(null)}catch(e){l(e instanceof o?"API Error: ".concat(e.message):"An unexpected error occurred."),console.error(e)}},[]);return(0,n.useEffect)(()=>{r(!0),u().finally(()=>r(!1))},[u]),(0,s.jsxs)("main",{className:"container mx-auto p-8",children:[(0,s.jsx)(eQ,{wallets:e,onWalletUpdate:u,onTransactionUpdate:u}),(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Wallets"}),(0,s.jsx)(J,{})]}),a&&(0,s.jsx)("p",{children:"Loading wallets..."}),i&&(0,s.jsx)("p",{className:"text-red-500",children:i}),!a&&!i&&(0,s.jsx)(eK,{wallets:e,onWalletClick:d}),(0,s.jsx)("div",{className:"mt-8 flex justify-center",children:(0,s.jsx)(ew,{onWalletCreated:u})}),c&&(0,s.jsx)(eZ,{sourceWallet:c,allWallets:e,isOpen:!!c,onOpenChange:()=>d(null),onTransactionScheduled:u})]})}v.BASE="https://n7d6wysyal.execute-api.us-west-2.amazonaws.com/api"}},e=>{e.O(0,[720,275,441,255,358],()=>e(e.s=1704)),_N_E=e.O()}]);